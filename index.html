<!DOCTYPE html>
<html>
<head>
    <title>Windows 98 Art Gallery</title>
    <style>
        body {
            margin: 0;
            height: 100vh;
            width: 100vw;
            overflow: hidden;
            background: url("wallpaper.jpg") no-repeat center center fixed;
            background-size: cover;
            font-family: "MS Sans Serif", Tahoma, sans-serif;
        }

        /* Windows */
        .window, .viewer-window {
            position: absolute;
            background: #C0C0C0;
            border: 2px solid #FFF;
            border-right-color: #000;
            border-bottom-color: #000;
            box-sizing: border-box;
        }

        .title-bar {
            background: linear-gradient(to right, #000080, #1084d0);
            color: white;
            padding: 3px 5px;
            font-weight: bold;
            display: flex;
            justify-content: space-between;
            cursor: move;
            user-select: none;
        }

        .resizer {
            width: 14px;
            height: 14px;
            position: absolute;
            right: 0;
            bottom: 0;
            cursor: se-resize;
            background: url('data:image/gif;base64,R0lGODlhDAAMAJEAAAAAAP///wAAACH5BAEAAAIALAAAAAAMAAwAAAIRhI+py+0Po5y02ouz3pwXADs=') no-repeat center;
            image-rendering: pixelated;
        }

        /* Gallery grid boxes */
        .gallery {
            display: grid;
            grid-template-columns: repeat(auto-fill, 150px); /* fixed width boxes */
            grid-auto-rows: 150px; /* fixed height boxes */
            gap: 10px;
        }

        .gallery .img-box {
            background: #C0C0C0; /* opaque PNG background */
            border: 2px solid #FFF;
            border-right-color: #000;
            border-bottom-color: #000;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            cursor: pointer;
        }

        .gallery .img-box img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain; /* keeps image inside box */
            display: block;
        }
    </style>
</head>
<body>

<div class="window" id="mainWindow" style="top:50px; left:50px; width:700px; height:500px;">
    <div class="title-bar">
        <div>Art Gallery</div>
    </div>
    <div class="content">
        <div class="gallery"></div>
    </div>
    <div class="resizer"></div>
</div>

<script>
/* DRAGGABLE & RESIZABLE WINDOWS */
function makeDraggable(win) {
    const bar = win.querySelector(".title-bar");
    let isDown = false, offsetX = 0, offsetY = 0;
    bar.addEventListener("mousedown", e => {
        isDown = true;
        offsetX = e.clientX - win.offsetLeft;
        offsetY = e.clientY - win.offsetTop;
    });
    document.addEventListener("mouseup", () => isDown = false);
    document.addEventListener("mousemove", e => {
        if (!isDown) return;
        win.style.left = (e.clientX - offsetX) + "px";
        win.style.top = (e.clientY - offsetY) + "px";
    });
}

function enableResize(win) {
    const resizer = win.querySelector(".resizer");
    let isResizing = false;
    resizer.addEventListener("mousedown", e => {
        e.preventDefault();
        isResizing = true;
        const startX = e.clientX;
        const startY = e.clientY;
        const startWidth = parseInt(window.getComputedStyle(win).width);
        const startHeight = parseInt(window.getComputedStyle(win).height);

        function mouseMove(e) {
            if (!isResizing) return;
            win.style.width = (startWidth + (e.clientX - startX)) + "px";
            win.style.height = (startHeight + (e.clientY - startY)) + "px";
        }
        function mouseUp() { isResizing = false; document.removeEventListener("mousemove", mouseMove); document.removeEventListener("mouseup", mouseUp); }
        document.addEventListener("mousemove", mouseMove);
        document.addEventListener("mouseup", mouseUp);
    });
}

const mainWindow = document.getElementById("mainWindow");
makeDraggable(mainWindow);
enableResize(mainWindow);

/* GALLERY: LOAD IMAGES FROM GITHUB */
fetch("https://api.github.com/repos/thybytecast/Art-gallery/contents/art")
    .then(r => r.json())
    .then(files => {
        const gallery = document.querySelector(".gallery");
        files.forEach(file => {
            if(file.name.match(/\.(jpg|jpeg|png|gif)$/i)) {
                const box = document.createElement("div");
                box.className = "img-box";
                const img = document.createElement("img");
                img.src = file.download_url;

                img.onload = () => {
                    // Image viewer will resize to exact image dimensions
                    img.dataset.width = img.naturalWidth;
                    img.dataset.height = img.naturalHeight;
                };

                img.onclick = () => openImageViewer(img.src, img.dataset.width, img.dataset.height);
                box.appendChild(img);
                gallery.appendChild(box);
            }
        });
    });

/* IMAGE VIEWER POPUP: resize to image size */
function openImageViewer(src, width, height) {
    const viewer = document.createElement("div");
    viewer.className = "viewer-window";
    viewer.style.top = "100px";
    viewer.style.left = "100px";

    viewer.innerHTML = `
        <div class="title-bar">Image Viewer</div>
        <img src="${src}" style="display:block;">
        <div class="resizer"></div>
    `;
    document.body.appendChild(viewer);

    // resize window to image size
    const img = viewer.querySelector("img");
    img.onload = () => {
        let w = img.naturalWidth;
        let h = img.naturalHeight;

        // limit to viewport if too large
        const maxWidth = window.innerWidth - 50;
        const maxHeight = window.innerHeight - 50;
        const ratio = Math.min(maxWidth / w, maxHeight / h, 1);
        w *= ratio;
        h *= ratio;

        viewer.style.width = w + "px";
        viewer.style.height = h + 24 + "px"; // 24px for title bar
        img.style.width = w + "px";
        img.style.height = h + "px";
    };

    makeDraggable(viewer);
    enableResize(viewer);
}
</script>

</body>
</html>
